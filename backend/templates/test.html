{% extends "base.html" %}

{% block title %}RIASEC Test - CareerGo{% endblock %}

{% block loading_text %}Thinking...{% endblock %}

{% block content %}
<section class="page active" id="test">
    <div class="test-container">
        <h1 class="section-title">Trắc nghiệm RIASEC</h1>
        <div class="journey-stepper" aria-label="Hành trình hướng nghiệp">
            <div class="journey-step active"><span class="step-dot">1</span><span>Trắc nghiệm</span></div>
            <div class="journey-step"><span class="step-dot">2</span><span>Kết quả</span></div>
            <div class="journey-step"><span class="step-dot">3</span><span>VR</span></div>
            <div class="journey-step"><span class="step-dot">4</span><span>AI Chat</span></div>
        </div>
        <div class="journey-next panel">
            <strong>Bước tiếp theo</strong>
            <p class="muted">Hoàn thành 50 câu và nộp bài để xem kết quả nghề nghiệp phù hợp.</p>
            <div class="center-actions">
                <button type="button" class="btn btn-secondary" onclick="goPage('results')">Xem kết quả gần nhất</button>
                <button type="button" class="btn btn-secondary" onclick="goPage('profile')">Cập nhật hồ sơ</button>
            </div>
        </div>

        <div class="test-section panel-soft">
            <h2>Thông tin cá nhân</h2>
            <div class="form-grid-3">
                <div class="field">
                    <label for="name">Họ và tên</label>
                    <input class="input" type="text" id="name" placeholder="Nguyễn Văn A">
                </div>
                <div class="field">
                    <label for="class">Lớp</label>
                    <input class="input" type="text" id="class" placeholder="10A1">
                </div>
                <div class="field">
                    <label for="school">Trường</label>
                    <input class="input" type="text" id="school" placeholder="THPT ...">
                </div>
            </div>
        </div>

        <div class="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
            <div class="progress-text">
                <span id="progressText">0 / 50 câu</span>
                <span id="estimatedTime">~10 phút</span>
            </div>
            <div class="test-chunk-toolbar">
                <div id="chunkIndicator" class="muted">Phần 1 / 5</div>
                <div class="chunk-actions">
                    <button type="button" id="btnChunkPrev" class="btn btn-secondary" onclick="prevTestChunk()">Phần trước</button>
                    <button type="button" id="btnChunkNext" class="btn btn-secondary" onclick="nextTestChunk()">Phần tiếp theo</button>
                </div>
            </div>
            <div id="testAutosaveStatus" class="muted test-autosave-status">Chưa có bản nháp tự động.</div>
        </div>

        <div class="scale-explanation">
            <strong>Hướng dẫn trả lời:</strong> Với mỗi câu hỏi, hãy đánh giá từ 1 (Rất không đúng) đến 5 (Rất đúng)
            <div class="scale-legend">
                <div class="scale-item">1️⃣ Rất không đúng</div>
                <div class="scale-item">2️⃣ Không đúng</div>
                <div class="scale-item">3️⃣ Phân vân</div>
                <div class="scale-item">4️⃣ Đúng</div>
                <div class="scale-item">5️⃣ Rất đúng</div>
            </div>
        </div>

        <form id="testForm">
            <div id="questionsContainer"></div>
            <div class="test-actions">
                <button type="button" onclick="submitTest()" class="btn btn-primary">Nộp bài và xem kết quả</button>
                <button type="button" class="btn btn-secondary" onclick="resetTest()">Làm lại</button>
                <button type="button" id="btnDevFill" class="btn btn-secondary admin-only" onclick="devAutoFill()">Dev
                    Fill</button>
            </div>
            <div id="testFormStatus" class="status" role="status" aria-live="polite"></div>
        </form>
    </div>
</section>
{% endblock %}
