{% extends "base.html" %}

{% block title %}Tr·∫£i nghi·ªám VR - CareerGo{% endblock %}

{% block content %}
<section class="page active" id="vr-mode">
    <h1 class="section-title">Tr·∫£i nghi·ªám Ngh·ªÅ nghi·ªáp</h1>
    <div class="journey-stepper" aria-label="H√†nh tr√¨nh h∆∞·ªõng nghi·ªáp">
        <div class="journey-step"><span class="step-dot">1</span><span>Tr·∫Øc nghi·ªám</span></div>
        <div class="journey-step"><span class="step-dot">2</span><span>K·∫øt qu·∫£</span></div>
        <div class="journey-step active"><span class="step-dot">3</span><span>VR</span></div>
        <div class="journey-step"><span class="step-dot">4</span><span>AI Chat</span></div>
        <div class="journey-step"><span class="step-dot">5</span><span>C·ªông ƒë·ªìng</span></div>
    </div>
    <p class="section-subtitle">
        Kh√°m ph√° m√¥i tr∆∞·ªùng l√†m vi·ªác th·ª±c t·∫ø qua c√°c video m√¥ ph·ªèng ngh·ªÅ nghi·ªáp. Ch·ªçn m·ªôt ngh·ªÅ ƒë·ªÉ tr·∫£i nghi·ªám!
    </p>
    <div class="journey-next panel">
        <strong>B∆∞·ªõc ti·∫øp theo</strong>
        <p class="muted">Sau khi xem video ngh·ªÅ ph√π h·ª£p, b·∫°n c√≥ th·ªÉ h·ªèi AI ƒë·ªÉ l·∫≠p k·∫ø ho·∫°ch v√† th·∫£o lu·∫≠n th√™m v·ªõi c·ªông ƒë·ªìng.</p>
        <div class="center-actions">
            <button class="btn btn-primary" onclick="goPage('chatbot')">Ti·∫øp t·ª•c v·ªõi AI Chat</button>
            <button class="btn btn-secondary" onclick="goPage('community')">M·ªü C·ªông ƒë·ªìng</button>
        </div>
    </div>

    <div class="vr-browse-panel panel panel-soft">
        <h3>Kh√°m ph√° ngh·ªÅ nghi·ªáp</h3>
        <p class="helper-text">T√¨m nhanh ngh·ªÅ theo t·ª´ kh√≥a, nh√≥m RIASEC v√† m·ª©c ƒë·ªô g·ª£i √Ω ph√π h·ª£p v·ªõi k·∫øt qu·∫£ c·ªßa b·∫°n.</p>
        <div class="vr-browse-controls">
            <label for="vrSearchInput" class="sr-only">T√¨m ngh·ªÅ theo t·ª´ kh√≥a</label>
            <input id="vrSearchInput" class="community-input" type="text" placeholder="T√¨m ngh·ªÅ (v√≠ d·ª•: l·∫≠p tr√¨nh, b√°c sƒ©...)">
            <label for="vrFilterRiasec" class="sr-only">L·ªçc theo nh√≥m RIASEC</label>
            <select id="vrFilterRiasec" class="community-input vr-browse-select">
                <option value="all">T·∫•t c·∫£ nh√≥m RIASEC</option>
                <option value="R">R - Th·ª±c t·∫ø</option>
                <option value="I">I - Nghi√™n c·ª©u</option>
                <option value="A">A - Ngh·ªá thu·∫≠t</option>
                <option value="S">S - X√£ h·ªôi</option>
                <option value="E">E - Qu·∫£n l√Ω</option>
                <option value="C">C - Nghi·ªáp v·ª•</option>
            </select>
            <label for="vrFilterScope" class="sr-only">L·ªçc ph·∫°m vi hi·ªÉn th·ªã</label>
            <select id="vrFilterScope" class="community-input vr-browse-select">
                <option value="all">Hi·ªÉn th·ªã: T·∫•t c·∫£</option>
                <option value="recommended">Ch·ªâ ngh·ªÅ g·ª£i √Ω ∆∞u ti√™n</option>
            </select>
            <button type="button" class="btn btn-secondary" onclick="resetVRBrowseFilters()">X√≥a b·ªô l·ªçc</button>
        </div>
        <p id="vrBrowseSummary" class="muted" role="status" aria-live="polite">ƒêang t·∫£i danh s√°ch ngh·ªÅ nghi·ªáp...</p>
    </div>

    <div id="vrControls" class="vr-admin-panel is-hidden">
        <div id="devTools" class="admin-only panel panel-soft vr-admin-tools">
            <h3>Qu·∫£n l√Ω n·ªôi dung ngh·ªÅ nghi·ªáp</h3>
            <div class="vr-admin-groups">
                <div class="vr-admin-group">
                    <h4>Th√™m th·ªß c√¥ng</h4>
                    <div class="vr-admin-actions">
                        <button class="btn btn-primary" onclick="addNewVRJob()">Th√™m ngh·ªÅ m·ªõi</button>
                        <button class="btn btn-secondary" onclick="resetVRData()">L√†m m·ªõi th·ª≠ nghi·ªám</button>
                    </div>
                    <p class="helper-text">Nh·∫≠p m√£ RIASEC 3 k√Ω t·ª± (v√≠ d·ª•: RIA), ∆∞u ti√™n k√Ω t·ª± ƒë·∫ßu l√† nh√≥m ngh·ªÅ ch√≠nh.</p>
                </div>

                <div class="vr-admin-group">
                    <h4>Nh·∫≠p t·ª´ Excel</h4>
                    <div class="vr-admin-actions">
                        <button class="btn btn-secondary" onclick="downloadVRTemplate()">T·∫£i m·∫´u Excel</button>
                        <label class="btn btn-secondary upload-label">
                        üì§ Ch·ªçn file Excel
                        <input id="vrImportFile" type="file" accept=".xlsx" class="file-input-hidden">
                        </label>
                        <button id="btnVrImport" class="btn btn-secondary" onclick="handleImport()" disabled>Nh·∫≠p d·ªØ li·ªáu</button>
                    </div>
                    <p id="vrSelectedFile" class="helper-text">Ch∆∞a ch·ªçn t·ªáp nh·∫≠p d·ªØ li·ªáu.</p>
                    <div id="vrImportStatus" class="status" role="status" aria-live="polite"></div>
                    <div id="vrImportWarnings" class="status status-warning" role="status" aria-live="polite"></div>
                    <div id="vrImportErrors" class="status status-error" role="status" aria-live="polite"></div>
                    <div id="vrLastImport" class="vr-last-import muted" role="status" aria-live="polite"></div>
                </div>
            </div>
        </div>
        <p id="vrRoleHint" class="helper-text vr-role-hint">
            Khu v·ª±c qu·∫£n tr·ªã ch·ªâ hi·ªÉn th·ªã cho t√†i kho·∫£n Admin. H·ªçc sinh v·∫´n c√≥ th·ªÉ xem v√† tr·∫£i nghi·ªám video ngh·ªÅ nghi·ªáp ·ªü ph·∫ßn tr√™n.
        </p>
    </div>

    <div id="vrGrid" class="vr-grid">
        <!-- Dynamic content will be loaded here -->
    </div>
</section>
{% endblock %}

{% block modals %}
<!-- VIDEO MODAL -->
<div id="videoModal" class="loading-overlay" onclick="closeVideoModal(event)" role="dialog" aria-modal="true" aria-hidden="true"
    aria-labelledby="videoTitle" tabindex="-1">
    <div class="loading-modal modal-card">
        <div class="modal-close-row">
            <button onclick="closeVideoModal()" class="icon-btn" aria-label="ƒê√≥ng video">&times;</button>
        </div>
        <div class="video-frame-wrap">
            <iframe id="videoFrame" src="" class="video-frame" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
            </iframe>
        </div>
        <h3 id="videoTitle" class="modal-video-title"></h3>
    </div>
</div>

<!-- DEV EDITOR MODAL -->
<div id="devJobModal" class="loading-overlay" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="devModalTitle"
    tabindex="-1">
    <div class="loading-modal panel modal-card-sm-left">
        <h2 id="devModalTitle" class="section-title modal-title-tight">Ch·ªânh s·ª≠a Video VR</h2>

        <input type="hidden" id="devJobId">

        <div class="field">
            <label>Ti√™u ƒë·ªÅ:</label>
            <input class="input" type="text" id="devJobTitle">
        </div>

        <div class="field">
            <label>YouTube Video ID:</label>
            <input class="input" type="text" id="devJobVideoId" placeholder="VD: BZgv0k_0IQs">
        </div>

        <div class="field">
            <label>M√£ RIASEC (3 k√Ω t·ª±):</label>
            <input class="input input-uppercase" type="text" id="devJobRiasec" placeholder="VD: RIA">
        </div>

        <div class="field">
            <label>M√¥ t·∫£:</label>
            <textarea class="input" id="devJobDesc" rows="3"></textarea>
        </div>

        <div class="field">
            <label>Icon (Emoji):</label>
            <input class="input" type="text" id="devJobIcon" placeholder="üé•">
        </div>

        <div class="center-actions actions-end">
            <button id="btnDeleteJob" onclick="deleteVRJob()" class="btn btn-secondary is-hidden">X√≥a</button>
            <button onclick="closeDevModal()" class="btn btn-secondary">H·ªßy</button>
            <button onclick="saveDevJob()" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
        </div>
        <div id="vrModalStatus" class="status" role="status" aria-live="polite"></div>
    </div>
</div>
{% endblock %}
