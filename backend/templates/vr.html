{% extends "base.html" %}

{% block title %}Tr·∫£i nghi·ªám VR - CareerGo{% endblock %}

{% block content %}
<section class="page active" id="vr-mode">
    <h1 class="section-title">Tr·∫£i nghi·ªám Ngh·ªÅ nghi·ªáp</h1>
    <div class="journey-stepper" aria-label="H√†nh tr√¨nh h∆∞·ªõng nghi·ªáp">
        <div class="journey-step"><span class="step-dot">1</span><span>Tr·∫Øc nghi·ªám</span></div>
        <div class="journey-step"><span class="step-dot">2</span><span>K·∫øt qu·∫£</span></div>
        <div class="journey-step active"><span class="step-dot">3</span><span>VR</span></div>
        <div class="journey-step"><span class="step-dot">4</span><span>AI Chat</span></div>
    </div>
    <p class="section-subtitle">
        Kh√°m ph√° m√¥i tr∆∞·ªùng l√†m vi·ªác th·ª±c t·∫ø qua c√°c video m√¥ ph·ªèng ngh·ªÅ nghi·ªáp. Ch·ªçn m·ªôt ngh·ªÅ ƒë·ªÉ tr·∫£i nghi·ªám!
    </p>
    <div class="journey-next panel">
        <strong>B∆∞·ªõc ti·∫øp theo</strong>
        <p class="muted">Sau khi xem video ngh·ªÅ ph√π h·ª£p, b·∫°n c√≥ th·ªÉ quay l·∫°i k·∫øt qu·∫£ ho·∫∑c ti·∫øp t·ª•c h·ªèi AI ƒë·ªÉ l·∫≠p k·∫ø ho·∫°ch h·ªçc t·∫≠p.</p>
        <div class="center-actions">
            <button class="btn btn-secondary" onclick="goPage('results')">Quay l·∫°i K·∫øt qu·∫£</button>
            <button class="btn btn-secondary" onclick="goPage('chatbot')">Ti·∫øp t·ª•c v·ªõi AI Chat</button>
        </div>
    </div>

    <div id="vrControls" class="vr-admin-panel" style="display: none;">
        <div id="devTools" class="admin-only panel panel-soft">
            <h3>Qu·∫£n l√Ω n·ªôi dung ngh·ªÅ nghi·ªáp</h3>
            <div class="vr-admin-groups">
                <div class="vr-admin-group">
                    <h4>Th√™m th·ªß c√¥ng</h4>
                    <div class="vr-admin-actions">
                        <button class="btn btn-primary" onclick="addNewVRJob()">Th√™m ngh·ªÅ m·ªõi</button>
                        <button class="btn btn-secondary" onclick="resetVRData()">Reset th·ª≠ nghi·ªám</button>
                    </div>
                    <p class="helper-text">Nh·∫≠p m√£ RIASEC 3 k√Ω t·ª± (v√≠ d·ª•: RIA), ∆∞u ti√™n k√Ω t·ª± ƒë·∫ßu l√† nh√≥m ngh·ªÅ ch√≠nh.</p>
                </div>

                <div class="vr-admin-group">
                    <h4>Import Excel</h4>
                    <div class="vr-admin-actions">
                        <button class="btn btn-secondary" onclick="downloadVRTemplate()">T·∫£i m·∫´u Excel</button>
                        <label class="btn btn-secondary upload-label">
                        üì§ Ch·ªçn file Excel
                        <input id="vrImportFile" type="file" accept=".xlsx" style="display: none;">
                        </label>
                        <button id="btnVrImport" class="btn btn-secondary" onclick="handleImport()" disabled>Import</button>
                    </div>
                    <p id="vrSelectedFile" class="helper-text">Ch∆∞a ch·ªçn file import.</p>
                    <div id="vrImportStatus" class="status" role="status" aria-live="polite"></div>
                    <div id="vrImportErrors" class="status status-error" role="status" aria-live="polite"></div>
                    <div id="vrLastImport" class="vr-last-import muted" role="status" aria-live="polite"></div>
                </div>
            </div>
        </div>
        <p id="vrRoleHint" class="helper-text" style="text-align: center; margin-top: 0.5rem;">
            C√¥ng c·ª• th√™m/import ch·ªâ hi·ªÉn th·ªã cho t√†i kho·∫£n qu·∫£n tr·ªã (Admin).
        </p>
    </div>

    <div id="vrGrid" class="vr-grid">
        <!-- Dynamic content will be loaded here -->
    </div>
</section>
{% endblock %}

{% block modals %}
<!-- VIDEO MODAL -->
<div id="videoModal" class="loading-overlay" onclick="closeVideoModal(event)" role="dialog" aria-modal="true"
    aria-labelledby="videoTitle" tabindex="-1">
    <div class="loading-modal modal-card">
        <div class="modal-close-row">
            <button onclick="closeVideoModal()" class="icon-btn" aria-label="ƒê√≥ng video">&times;</button>
        </div>
        <div class="video-frame-wrap">
            <iframe id="videoFrame" src="" class="video-frame" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
            </iframe>
        </div>
        <h3 id="videoTitle" style="margin-top: 1rem; color: #4d7cff;"></h3>
    </div>
</div>

<!-- DEV EDITOR MODAL -->
<div id="devJobModal" class="loading-overlay" role="dialog" aria-modal="true" aria-labelledby="devModalTitle"
    tabindex="-1">
    <div class="loading-modal panel" style="width: 90%; max-width: 500px; text-align: left;">
        <h2 id="devModalTitle" class="section-title" style="margin: 0 0 1rem;">Ch·ªânh s·ª≠a Video VR</h2>

        <input type="hidden" id="devJobId">

        <div class="field">
            <label>Ti√™u ƒë·ªÅ:</label>
            <input class="input" type="text" id="devJobTitle">
        </div>

        <div class="field">
            <label>YouTube Video ID:</label>
            <input class="input" type="text" id="devJobVideoId" placeholder="VD: BZgv0k_0IQs">
        </div>

        <div class="field">
            <label>M√£ RIASEC (3 k√Ω t·ª±):</label>
            <input class="input" type="text" id="devJobRiasec" placeholder="VD: RIA" style="text-transform: uppercase;">
        </div>

        <div class="field">
            <label>M√¥ t·∫£:</label>
            <textarea class="input" id="devJobDesc" rows="3"></textarea>
        </div>

        <div class="field">
            <label>Icon (Emoji):</label>
            <input class="input" type="text" id="devJobIcon" placeholder="üé•">
        </div>

        <div class="center-actions" style="justify-content: flex-end;">
            <button id="btnDeleteJob" onclick="deleteVRJob()" class="btn btn-secondary" style="display: none;">X√≥a</button>
            <button onclick="closeDevModal()" class="btn btn-secondary">H·ªßy</button>
            <button onclick="saveDevJob()" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
        </div>
        <div id="vrModalStatus" class="status" role="status" aria-live="polite"></div>
    </div>
</div>
{% endblock %}
